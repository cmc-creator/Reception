<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Destiny Springs | Hub Matrix</title>
    <!-- System Engines -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        * { font-style: normal !important; scrollbar-width: none; }
        ::-webkit-scrollbar { display: none; }
        body { font-family: 'Inter', sans-serif; background: #000; color: #fff; overflow: hidden; }
        
        .glass-panel { background: rgba(255,255,255,0.02); backdrop-filter: blur(25px); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; }
        .neon-blue { border: 1px solid rgba(0, 243, 255, 0.4); box-shadow: inset 0 0 20px rgba(0, 243, 255, 0.05); }
        .neon-fuchsia { border: 1px solid rgba(255, 0, 255, 0.4); box-shadow: inset 0 0 20px rgba(255, 0, 255, 0.05); }
        .holo-text { text-shadow: 0 0 10px rgba(0, 243, 255, 0.5); }
        
        .alert-pulse { animation: alert-glow 2s infinite; }
        .status-pulse { animation: status-glow 1.5s infinite; }
        @keyframes alert-glow { 0% { opacity: 0.4; } 50% { opacity: 1; } 100% { opacity: 0.4; } }
        @keyframes status-glow { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.3); opacity: 0.5; } 100% { transform: scale(1); opacity: 1; } }

        @media print {
            .no-print { display: none !important; }
            body { background: white !important; color: black !important; }
            .calendar-grid { border: 1px solid black !important; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // --- ADMIN CONFIGURATION ---
        const ADMIN_CODE = 'admin123'; // Change this to your desired admin password

        // --- LOCALSTORAGE DATA LAYER ---
        const STORAGE_KEYS = {
            SHIFTS: 'reception_shifts',
            STAFF: 'reception_staff',
            MESSAGES: 'reception_messages',
            REPORTS: 'reception_reports',
            ALERT: 'reception_alert',
            INITIALIZED: 'reception_initialized'
        };

        function saveToStorage(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify(data));
            } catch (e) {
                console.error('Failed to save to localStorage:', e);
            }
        }

        function loadFromStorage(key, defaultValue = null) {
            try {
                const item = localStorage.getItem(key);
                return item ? JSON.parse(item) : defaultValue;
            } catch (e) {
                console.error('Failed to load from localStorage:', e);
                return defaultValue;
            }
        }

        function clearAllStorage() {
            Object.values(STORAGE_KEYS).forEach(key => localStorage.removeItem(key));
        }

        // --- ICON SUITE ---
        const IconCalendar = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>;
        const IconSync = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></svg>;
        const IconPersonnel = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg>;
        const IconPlus = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>;
        const IconAlert = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>;
        const IconChevronL = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="15 18 9 12 15 6"/></svg>;
        const IconChevronR = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6"/></svg>;
        const IconLock = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>;
        const IconTrash = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>;
        const IconActivity = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>;
        const IconTerminal = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg>;

        const REPORT_FIELDS = [
            { id: 'mail', label: 'Mail / Deliveries' }, 
            { id: 'property', label: 'Patient Property' },
            { id: 'supplies', label: 'Hub Supplies' }, 
            { id: 'lobby', label: 'Lobby Status' },
            { id: 'aoc', label: 'AOC Status' }
        ];

        // --- DETERMINISTIC SEED DATA FOR FIRST LOAD ---
        function initializeSeedData() {
            // Seed staff
            const seedStaff = {
                'unit-karen': { id: 'unit-karen', name: 'Karen', bg: 'bg-cyan-600/80' },
                'unit-izzy': { id: 'unit-izzy', name: 'Izzy', bg: 'bg-rose-600/80' },
                'unit-annalissia': { id: 'unit-annalissia', name: 'Annalissia', bg: 'bg-fuchsia-600/80' },
                'unit-hal': { id: 'unit-hal', name: 'Hal', bg: 'bg-blue-600/80' }
            };
            saveToStorage(STORAGE_KEYS.STAFF, seedStaff);

            // Seed shifts for current month
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const shifts = {};
            
            for (let d = 1; d <= daysInMonth; d++) {
                const date = new Date(year, month, d);
                const dateKey = `${year}-${String(month + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
                const dow = date.getDay();
                
                // Create sample shifts based on day of week
                if (dow === 1 || dow === 3) { // Mon, Wed
                    shifts[dateKey] = [{ id: `shift-${Date.now()}-${d}-1`, date: dateKey, empId: 'unit-karen', time: '08:00', confirmed: true }];
                } else if (dow === 2 || dow === 4 || dow === 5) { // Tue, Thu, Fri
                    shifts[dateKey] = [{ id: `shift-${Date.now()}-${d}-2`, date: dateKey, empId: 'unit-izzy', time: '08:00', confirmed: true }];
                } else if (dow === 0) { // Sunday
                    shifts[dateKey] = [
                        { id: `shift-${Date.now()}-${d}-3`, date: dateKey, empId: 'unit-hal', time: '16:00', confirmed: true },
                        { id: `shift-${Date.now()}-${d}-4`, date: dateKey, empId: 'unit-annalissia', time: '08:00', confirmed: true }
                    ];
                }
            }
            saveToStorage(STORAGE_KEYS.SHIFTS, shifts);

            // Seed messages
            const seedMessages = [
                { id: 'msg-1', text: 'Welcome to Reception! Your calendar is ready.', user: 'SYSTEM', createdAt: Date.now() - 7200000 },
                { id: 'msg-2', text: 'All data is stored locally in your browser.', user: 'SYSTEM', createdAt: Date.now() - 3600000 },
                { id: 'msg-3', text: 'Use the Export Matrix button to print or save your schedule.', user: 'INFO', createdAt: Date.now() }
            ];
            saveToStorage(STORAGE_KEYS.MESSAGES, seedMessages);

            // Seed report data for today
            const today = now.toISOString().split('T')[0];
            const seedReports = {
                [today]: {
                    mail: 'Sample: Mail delivery expected at 2 PM',
                    property: 'Sample: All patient property secured',
                    supplies: 'Sample: Stock levels normal',
                    lobby: 'Sample: Clean and organized',
                    aoc: 'Sample: All systems operational'
                }
            };
            saveToStorage(STORAGE_KEYS.REPORTS, seedReports);

            // Seed alert
            saveToStorage(STORAGE_KEYS.ALERT, 'Welcome to Reception - Your offline staff calendar');

            // Mark as initialized
            saveToStorage(STORAGE_KEYS.INITIALIZED, true);
        }

        function App() {
            // --- Application State ---
            const [currentDate, setCurrentDate] = useState(() => {
                const now = new Date();
                return new Date(now.getFullYear(), now.getMonth(), 1);
            });
            const [selectedDate, setSelectedDate] = useState(() => new Date().toISOString().split('T')[0]);
            const [events, setEvents] = useState({});
            const [staff, setStaff] = useState({});
            const [messages, setMessages] = useState([]);
            const [reportData, setReportData] = useState({});
            const [globalAlert, setGlobalAlert] = useState('');
            const [isPersonnelModalOpen, setIsPersonnelModalOpen] = useState(false);
            const [isAddModalOpen, setIsAddModalOpen] = useState(false);
            const [editingShift, setEditingShift] = useState(null);
            const [adminCode, setAdminCode] = useState('');
            const [isAdminAuth, setIsAdminAuth] = useState(false);
            const [chatInput, setChatInput] = useState('');
            const [newStaffName, setNewStaffName] = useState('');
            const chatEndRef = useRef(null);

            // --- Initialize Data from localStorage ---
            useEffect(() => {
                // Check if app has been initialized before
                const initialized = loadFromStorage(STORAGE_KEYS.INITIALIZED);
                
                if (!initialized) {
                    // First load - initialize with seed data
                    initializeSeedData();
                }

                // Load data from localStorage
                loadDataFromStorage();
            }, []);

            function loadDataFromStorage() {
                const loadedShifts = loadFromStorage(STORAGE_KEYS.SHIFTS, {});
                const loadedStaff = loadFromStorage(STORAGE_KEYS.STAFF, {});
                const loadedMessages = loadFromStorage(STORAGE_KEYS.MESSAGES, []);
                const loadedAlert = loadFromStorage(STORAGE_KEYS.ALERT, '');
                
                setEvents(loadedShifts);
                setStaff(loadedStaff);
                setMessages(loadedMessages);
                setGlobalAlert(loadedAlert);
            }

            // --- Load report data when selected date changes ---
            useEffect(() => {
                const allReports = loadFromStorage(STORAGE_KEYS.REPORTS, {});
                setReportData(allReports[selectedDate] || {});
            }, [selectedDate]);

            // --- Admin Master Reset Pattern ---
            function handleMasterReset() {
                const now = new Date();
                const currentMonth = now.toLocaleString('default', { month: 'long' });
                const currentYear = now.getFullYear();
                
                if (!confirm(`ADMIN MASTER RESET: Restore personnel Karen, Izzy, Annalissia, and Hal and force ${currentMonth} ${currentYear} Baseline schedule?`)) return;
                
                // Clear all data and re-initialize
                clearAllStorage();
                initializeSeedData();
                loadDataFromStorage();
                
                alert('Master reset complete!');
            }

            // --- UI Elements ---
            const calendarMatrix = useMemo(() => {
                const mIdx = currentDate.getMonth(), yIdx = currentDate.getFullYear();
                const total = new Date(yIdx, mIdx + 1, 0).getDate();
                const start = new Date(yIdx, mIdx, 1).getDay();
                const cells = [];
                // CALENDAR TALLER: min-h bumped to 180px
                for (let i = 0; i < start; i++) cells.push(<div key={`e-${i}`} className="min-h-[180px] bg-white/[0.01] border border-white/[0.03]" />);
                for (let d = 1; d <= total; d++) {
                    const dk = `${yIdx}-${String(mIdx + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
                    const dayShifts = events[dk] || [];
                    const isToday = new Date().toISOString().split('T')[0] === dk;
                    cells.push(
                        <div key={dk} onClick={() => setSelectedDate(dk)} className={`min-h-[180px] p-3 border border-white/[0.05] transition-all cursor-pointer relative group ${selectedDate === dk ? 'bg-cyan-500/10 ring-1 ring-cyan-400 shadow-inner' : 'bg-white/[0.01] hover:bg-white/[0.03]'} ${isToday ? 'border-l-2 border-l-cyan-400' : ''}`}>
                            <div className="flex justify-between items-start">
                                <span className={`text-xl font-black tracking-tighter ${selectedDate === dk ? 'text-cyan-400' : 'text-slate-600'}`}>{d}</span>
                                <button onClick={(e) => { e.stopPropagation(); setSelectedDate(dk); setIsAddModalOpen(true); }} className="p-1 opacity-20 hover:opacity-100 transition-opacity"><IconPlus /></button>
                            </div>
                            <div className="space-y-2 mt-4">
                                {dayShifts.length === 0 ? <div className="text-[10px] font-black text-rose-500 animate-pulse uppercase flex items-center gap-1 mt-2 text-left font-mono italic"><IconAlert /> Needs Coverage</div> : 
                                    dayShifts.map(s => (
                                        <div key={s.id} onClick={(e) => { e.stopPropagation(); setEditingShift(s); }} 
                                            className={`text-[13px] p-2 rounded-xl font-bold truncate text-white ${staff[s.empId]?.bg || 'bg-slate-700'} uppercase flex items-center justify-between text-left shadow-2xl border border-white/10 group-hover:scale-105 transition-transform cursor-pointer`}>
                                            <span>{staff[s.empId]?.name || '...'}</span>
                                            <span className="opacity-50 text-[10px] font-mono shrink-0">{s.time}</span>
                                        </div>
                                    ))
                                }
                            </div>
                        </div>
                    );
                }
                return cells;
            }, [currentDate, events, selectedDate, staff]);

            return (
                <div className="flex h-screen w-screen bg-black overflow-hidden text-xs">
                    {/* NAV RAIL */}
                    <nav className="no-print w-16 bg-[#050505] border-r border-white/5 flex flex-col items-center py-8 gap-10">
                        <div className="text-cyan-400 font-black text-xl holo-text">DS</div>
                        <button onClick={handleMasterReset} className="p-3 bg-cyan-500/10 rounded-xl border border-cyan-500/30 transition-all shadow-inner hover:scale-110" title="Admin Master Reset"><IconSync /></button>
                        <button onClick={() => setIsPersonnelModalOpen(true)} className="p-3 bg-fuchsia-500/10 rounded-xl border border-fuchsia-500/30 transition-all hover:scale-110" title="Personnel Manifest"><IconPersonnel /></button>
                        <div className="mt-auto flex flex-col items-center gap-3">
                            <div className="w-2.5 h-2.5 rounded-full status-pulse bg-emerald-500 shadow-[0_0_10px_#10b981]" title="Local Storage Ready" />
                            <div className="opacity-10 text-[8px] font-black uppercase rotate-90 tracking-widest font-mono">Protocol</div>
                        </div>
                    </nav>

                    <div className="flex-1 flex flex-col">
                        <header className="no-print h-10 bg-rose-950/20 border-b border-rose-500/30 flex items-center px-6 gap-4 text-left font-bold">
                            <div className="flex items-center gap-2 text-rose-500 font-black text-[9px] uppercase tracking-widest alert-pulse shrink-0"><IconAlert /> Critical Intel</div>
                            <input value={globalAlert} onChange={e => { 
                                const newAlert = String(e.target.value);
                                setGlobalAlert(newAlert);
                                saveToStorage(STORAGE_KEYS.ALERT, newAlert);
                            }} className="flex-1 bg-transparent border-none text-[11px] font-bold text-white outline-none placeholder-rose-900" placeholder="Broadcast immediate hub directive..." />
                        </header>

                        <div className="flex-1 flex overflow-hidden">
                            {/* SIDEBAR LOGS */}
                            <aside className="no-print w-80 bg-[#080808] border-r border-white/5 p-5 flex flex-col gap-4 overflow-y-auto no-scrollbar">
                                <header className="text-left mb-2 text-white font-black">
                                    <h1 className="text-lg tracking-tighter holo-text uppercase">Archive Logs</h1>
                                    <div className="text-[10px] text-cyan-400 font-bold uppercase mt-1 tracking-widest font-mono">{selectedDate}</div>
                                </header>
                                <div className="space-y-3">
                                    {REPORT_FIELDS.map(f => (
                                        <div key={f.id} className="glass-panel neon-fuchsia p-3 text-left font-bold">
                                            <label className="text-[9px] font-black text-fuchsia-400 uppercase tracking-widest mb-1 block flex items-center gap-2 font-bold font-mono"><IconActivity /> {f.label}</label>
                                            <textarea value={String(reportData[f.id] || '')} onChange={e => {
                                                const newReportData = { ...reportData, [f.id]: e.target.value };
                                                setReportData(newReportData);
                                                const allReports = loadFromStorage(STORAGE_KEYS.REPORTS, {});
                                                allReports[selectedDate] = newReportData;
                                                saveToStorage(STORAGE_KEYS.REPORTS, allReports);
                                            }} className="w-full bg-transparent border-none text-xs text-white h-14 outline-none resize-none font-bold" placeholder="..." />
                                        </div>
                                    ))}
                                </div>
                                <div className="glass-panel neon-blue p-3 rounded-lg mt-auto text-left flex flex-col h-48">
                                    <label className="text-[9px] font-black text-cyan-400 uppercase tracking-widest mb-2 block flex items-center gap-2 font-mono tracking-widest font-bold"><IconTerminal className="inline mr-2"/>Live Intel Feed</label>
                                    <div className="flex-1 overflow-y-auto space-y-1.5 mb-2 text-[10px] no-scrollbar text-slate-300 font-medium">
                                        {messages.map(m => <div key={m.id}><span className="text-cyan-500 font-black mr-1 uppercase">{String(m.user)}:</span>{String(m.text)}</div>)}
                                        <div ref={chatEndRef} />
                                    </div>
                                    <form onSubmit={e => { 
                                        e.preventDefault(); 
                                        if (chatInput.trim()) { 
                                            const newMessage = { 
                                                id: `msg-${Date.now()}`, 
                                                text: chatInput, 
                                                createdAt: Date.now(), 
                                                user: 'USER' 
                                            };
                                            const updatedMessages = [...messages, newMessage].sort((a,b) => (a.createdAt || 0) - (b.createdAt || 0));
                                            setMessages(updatedMessages);
                                            saveToStorage(STORAGE_KEYS.MESSAGES, updatedMessages);
                                            setChatInput('');
                                            setTimeout(() => chatEndRef.current?.scrollIntoView({ behavior: "smooth" }), 100);
                                        }
                                    }} className="flex gap-1 shrink-0 pt-2 text-left">
                                        <input value={chatInput} onChange={e => setChatInput(e.target.value)} className="flex-1 bg-black border border-cyan-500/30 rounded p-1.5 text-[10px] outline-none text-white font-bold" placeholder="Broadcast..." />
                                        <button type="submit" className="bg-cyan-600 px-2 rounded text-white font-bold transition-all hover:bg-cyan-500 uppercase font-black tracking-widest">OK</button>
                                    </form>
                                </div>
                            </aside>

                            {/* MAIN GRID */}
                            <main className="flex-1 p-8 overflow-y-auto no-scrollbar text-center font-bold">
                                <div className="flex justify-between items-end mb-8 no-print text-left font-bold">
                                    <div className="text-white">
                                        <h2 className="text-5xl font-black uppercase tracking-tighter drop-shadow-[0_0_15px_rgba(255,255,255,0.2)] font-black">
                                            {currentDate.toLocaleDateString(undefined, { month: 'long', year: 'numeric' })}
                                        </h2>
                                        <div className="text-[10px] font-black text-cyan-400 tracking-[0.5em] uppercase mt-1">Matrix Interface Alpha</div>
                                    </div>
                                    <div className="flex gap-4">
                                        <div className="flex bg-white/5 rounded-xl border border-white/10 p-1 text-white font-bold">
                                            <button onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1))} className="p-2 hover:text-cyan-400 transition-colors border-r border-white/5 uppercase font-bold text-[10px]"><IconChevronL /></button>
                                            <button onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1))} className="p-2 hover:text-cyan-400 transition-colors uppercase font-bold text-[10px]"><IconChevronR /></button>
                                        </div>
                                        <button onClick={() => window.print()} className="bg-cyan-500 text-black px-6 py-2 rounded-xl font-black text-xs uppercase shadow-lg hover:bg-white transition-all font-bold">Export Matrix</button>
                                    </div>
                                </div>
                                <div className="grid grid-cols-7 glass-panel overflow-hidden neon-blue rounded-xl font-bold">
                                    {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(d => <div key={d} className="py-4 text-center text-[10px] font-black text-cyan-400/60 uppercase tracking-widest border-b border-white/5 bg-white/[0.02]">{d}</div>)}
                                    {calendarMatrix}
                                </div>
                            </main>
                        </div>
                    </div>

                    {/* MODAL: PERSONNEL */}
                    {isPersonnelModalOpen && (
                        <div className="fixed inset-0 bg-black/98 backdrop-blur-2xl z-[600] flex items-center justify-center p-4">
                            <div className="glass-panel neon-fuchsia p-10 w-full max-w-2xl max-h-[85vh] flex flex-col shadow-2xl rounded-[2rem]">
                                <div className="flex justify-between items-center mb-8 text-fuchsia-400 text-left">
                                    <h3 className="text-3xl font-black uppercase tracking-tighter">Manifest Hub</h3>
                                    <button onClick={() => { setIsPersonnelModalOpen(false); setIsAdminAuth(false); }} className="text-5xl font-light hover:text-white transition-colors">&times;</button>
                                </div>
                                {!isAdminAuth ? (
                                    <form onSubmit={e => { e.preventDefault(); if (adminCode === ADMIN_CODE) setIsAdminAuth(true); }} className="space-y-6 flex-1 flex flex-col justify-center items-center text-center font-bold">
                                        <div className="text-fuchsia-500 font-black text-xl flex items-center gap-3 alert-pulse">Restricted Access<br/><span className="text-[10px] opacity-40 uppercase tracking-widest font-bold font-mono"><IconLock className="inline mr-2"/> Code Required</span></div>
                                        <input type="password" value={adminCode} onChange={e => setAdminCode(e.target.value)} className="w-48 bg-black border border-fuchsia-500/40 rounded-xl p-4 text-center text-3xl text-white outline-none shadow-inner font-black" placeholder="****" autoFocus />
                                        <button type="submit" className="bg-fuchsia-600 px-12 py-3 rounded-xl font-black uppercase text-xs text-white shadow-lg transition-all hover:scale-105 active:scale-95 font-bold tracking-widest">Unlock Manifest</button>
                                    </form>
                                ) : (
                                    <div className="flex flex-col flex-1 overflow-hidden text-left font-bold">
                                        <div className="space-y-4 mb-8 text-white text-left font-bold font-mono">
                                            <label className="text-[10px] font-black text-slate-500 uppercase tracking-widest">Enroll New Unit</label>
                                            <div className="flex gap-3">
                                                <input value={newStaffName} onChange={e => setNewStaffName(e.target.value)} className="flex-1 bg-black border border-white/10 rounded-xl p-3 text-sm text-white font-black outline-none focus:border-fuchsia-500 font-bold" placeholder="Identity Label..." />
                                                <button onClick={() => { 
                                                    if (!newStaffName.trim()) return; 
                                                    const newId = `staff-${Date.now()}`;
                                                    const newStaff = { id: newId, name: String(newStaffName), bg: 'bg-slate-700', createdAt: Date.now() };
                                                    const updatedStaff = { ...staff, [newId]: newStaff };
                                                    setStaff(updatedStaff);
                                                    saveToStorage(STORAGE_KEYS.STAFF, updatedStaff);
                                                    setNewStaffName('');
                                                }} className="bg-fuchsia-600 px-6 rounded-xl font-black uppercase text-xs text-white shadow-lg transition-all hover:bg-fuchsia-500 font-bold tracking-widest">Enroll</button>
                                            </div>
                                        </div>
                                        <div className="flex-1 overflow-y-auto no-scrollbar space-y-2 pr-2 border-t border-white/5 pt-4 text-white text-left font-bold">
                                            {Object.entries(staff).map(([id, s]) => (
                                                <div key={id} className="flex items-center justify-between p-3 glass-panel neon-blue rounded-xl group border-white/5 transition-all hover:bg-white/[0.03]">
                                                    <div className="flex items-center gap-4 text-left font-bold font-mono">
                                                        <div className={`w-3 h-3 rounded-full ${s.bg || 'bg-slate-700'} shadow-white/20`} />
                                                        <span className="font-black uppercase text-sm">{String(s.name)}</span>
                                                    </div>
                                                    <button onClick={() => { 
                                                        if (!confirm("Terminate unit identifier?")) return;
                                                        const updatedStaff = { ...staff };
                                                        delete updatedStaff[id];
                                                        setStaff(updatedStaff);
                                                        saveToStorage(STORAGE_KEYS.STAFF, updatedStaff);
                                                        // Also remove shifts for this staff member
                                                        const updatedEvents = { ...events };
                                                        Object.keys(updatedEvents).forEach(date => {
                                                            updatedEvents[date] = updatedEvents[date].filter(shift => shift.empId !== id);
                                                            if (updatedEvents[date].length === 0) delete updatedEvents[date];
                                                        });
                                                        setEvents(updatedEvents);
                                                        saveToStorage(STORAGE_KEYS.SHIFTS, updatedEvents);
                                                    }} className="text-rose-500 font-black text-[9px] uppercase px-3 py-1 hover:bg-rose-500/10 rounded-lg border border-rose-500/30 font-mono font-bold tracking-widest">PURGE</button>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {/* ASSIGN MODAL */}
                    {isAddModalOpen && (
                        <div className="fixed inset-0 bg-black/90 backdrop-blur-md z-[500] flex items-center justify-center p-4 text-left font-bold text-white">
                            <div className="glass-panel neon-blue p-10 w-full max-w-md shadow-2xl rounded-3xl">
                                <h3 className="text-2xl font-black text-cyan-400 uppercase mb-8 tracking-tighter text-left font-mono font-bold">Deploy Identity</h3>
                                <div className="grid grid-cols-2 gap-2 mb-8">
                                    {Object.entries(staff).map(([id, s]) => <button key={id} onClick={() => {
                                        const newShift = {
                                            id: `shift-${Date.now()}`,
                                            date: selectedDate, 
                                            empId: id, 
                                            time: '08:00', 
                                            confirmed: true, 
                                            createdAt: Date.now()
                                        };
                                        const updatedEvents = { ...events };
                                        if (!updatedEvents[selectedDate]) updatedEvents[selectedDate] = [];
                                        updatedEvents[selectedDate].push(newShift);
                                        setEvents(updatedEvents);
                                        saveToStorage(STORAGE_KEYS.SHIFTS, updatedEvents);
                                        setIsAddModalOpen(false);
                                    }} className={`p-4 rounded-xl text-[14px] font-black uppercase text-white ${s.bg || 'bg-slate-700'} hover:scale-105 transition-all shadow-lg font-black`}>{String(s.name)}</button>)}
                                </div>
                                <button onClick={() => setIsAddModalOpen(false)} className="w-full text-slate-600 text-[10px] font-black uppercase tracking-[0.2em] pt-6 text-center hover:text-white transition-colors underline font-bold tracking-widest">Cancel deployment</button>
                            </div>
                        </div>
                    )}

                    {/* EDIT MODAL */}
                    {editingShift && (
                        <div className="fixed inset-0 bg-black/90 backdrop-blur-md z-[500] flex items-center justify-center p-4">
                            <div className="glass-panel neon-fuchsia p-8 w-full max-w-sm shadow-2xl rounded-3xl text-left font-bold text-white">
                                <h3 className="text-xl font-black uppercase mb-8 text-center text-white tracking-tighter font-bold font-mono tracking-widest">Adjust Link</h3>
                                <div className="space-y-6 text-center font-bold">
                                    <button onClick={() => { 
                                        const updatedEvents = { ...events };
                                        const dateShifts = updatedEvents[editingShift.date] || [];
                                        const shiftIndex = dateShifts.findIndex(s => s.id === editingShift.id);
                                        if (shiftIndex !== -1) {
                                            dateShifts[shiftIndex] = { ...dateShifts[shiftIndex], confirmed: !editingShift.confirmed };
                                            updatedEvents[editingShift.date] = dateShifts;
                                            setEvents(updatedEvents);
                                            setEditingShift({ ...editingShift, confirmed: !editingShift.confirmed });
                                            saveToStorage(STORAGE_KEYS.SHIFTS, updatedEvents);
                                        }
                                    }} className={`w-full py-4 rounded-xl font-black text-xs uppercase transition-all ${editingShift.confirmed ? 'bg-cyan-600 text-white shadow-[0_0_15px_rgba(6,182,212,0.4)]' : 'bg-rose-600 text-white shadow-[0_0_15px_rgba(225,29,72,0.4)]'}`}>{editingShift.confirmed ? 'Link: Verified' : 'Link: Lost'}</button>
                                    <div className="flex gap-3 font-bold">
                                        <button onClick={() => setEditingShift(null)} className="flex-1 bg-white text-black py-4 rounded-xl font-black uppercase text-xs hover:bg-cyan-400 transition-colors shadow-lg font-bold tracking-widest">Commit</button>
                                        <button onClick={() => { 
                                            if (!confirm("Terminate link?")) return;
                                            const updatedEvents = { ...events };
                                            const dateShifts = updatedEvents[editingShift.date] || [];
                                            updatedEvents[editingShift.date] = dateShifts.filter(s => s.id !== editingShift.id);
                                            if (updatedEvents[editingShift.date].length === 0) delete updatedEvents[editingShift.date];
                                            setEvents(updatedEvents);
                                            saveToStorage(STORAGE_KEYS.SHIFTS, updatedEvents);
                                            setEditingShift(null);
                                        }} className="bg-rose-600 px-8 py-4 rounded-xl text-white hover:bg-rose-500 shadow-lg font-bold"><IconTrash /></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
