<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Destiny Springs | Hub Matrix</title>
    <!-- Core Engine -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase Engine -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        * { font-style: normal !important; scrollbar-width: none; }
        ::-webkit-scrollbar { display: none; }
        body { font-family: 'Inter', sans-serif; background: #000; color: #fff; overflow: hidden; }
        
        .glass-panel { background: rgba(255,255,255,0.02); backdrop-filter: blur(25px); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; }
        .neon-blue { border: 1px solid rgba(0, 243, 255, 0.4); box-shadow: inset 0 0 20px rgba(0, 243, 255, 0.05); }
        .neon-fuchsia { border: 1px solid rgba(255, 0, 255, 0.4); box-shadow: inset 0 0 20px rgba(255, 0, 255, 0.05); }
        .holo-text { text-shadow: 0 0 10px rgba(0, 243, 255, 0.5); }
        
        .alert-pulse { animation: alert-glow 2s infinite; }
        .status-pulse { animation: status-glow 1.5s infinite; }
        @keyframes alert-glow { 0% { opacity: 0.4; } 50% { opacity: 1; } 100% { opacity: 0.4; } }
        @keyframes status-glow { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.3); opacity: 0.5; } 100% { transform: scale(1); opacity: 1; } }

        @media print {
            .no-print { display: none !important; }
            body { background: white !important; color: black !important; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // --- ICON SUITE ---
        const CalendarIcon = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#00f3ff" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" style={{ filter: 'drop-shadow(0 0 5px #00f3ff)' }}><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>;
        const SyncIcon = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#00f3ff" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></svg>;
        const PersonnelIcon = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff00ff" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" style={{ filter: 'drop-shadow(0 0 5px #ff00ff)' }}><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>;
        const PlusIcon = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#00f3ff" strokeWidth="3"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>;
        const AlertIcon = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#ff0000" strokeWidth="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>;
        const SendIcon = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>;
        const ChevronLeftIcon = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="15 18 9 12 15 6"/></svg>;
        const ChevronRightIcon = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="9 18 15 12 9 6"/></svg>;
        const LockIcon = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>;

        // --- INITIALIZATION ---
        const config = JSON.parse(window.__firebase_config || '{"apiKey":"AIzaSyCz9QHE7_2Ol6d5iFvJ2PGJwL-M5yxYbAE","authDomain":"reception-calendar-1.firebaseapp.com","projectId":"reception-calendar-1","storageBucket":"reception-calendar-1.firebasestorage.app","messagingSenderId":"613158953901","appId":"1:613158953901:web:ed3f0a6cc4cb23f65df724"}');
        const appId = window.__app_id || 'destiny-springs-hub';
        
        let db, auth;
        try {
            firebase.initializeApp(config);
            db = firebase.firestore();
            auth = firebase.auth();
        } catch (error) {
            console.error("Firebase initialization error:", error);
            const escapeHtml = (str) => String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#039;');
            document.body.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: center; height: 100vh; background: #000; color: #fff; flex-direction: column; padding: 40px; text-align: center; font-family: 'Inter', sans-serif;">
                    <div style="max-width: 600px;">
                        <h1 style="color: #ff0055; font-size: 32px; margin-bottom: 20px; font-weight: 800;">⚠️ Firebase Configuration Error</h1>
                        <p style="color: #00f3ff; font-size: 16px; margin-bottom: 20px; line-height: 1.6;">
                            The application failed to initialize. This is likely due to an invalid or missing Firebase API key.
                        </p>
                        <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(0,243,255,0.3); border-radius: 12px; padding: 20px; margin: 20px 0; text-align: left;">
                            <p style="color: #fff; font-size: 14px; margin-bottom: 10px; font-weight: 600;">To fix this issue:</p>
                            <ol style="color: #ccc; font-size: 13px; line-height: 1.8; margin-left: 20px;">
                                <li>Go to <a href="https://console.firebase.google.com/" target="_blank" style="color: #00f3ff;">Firebase Console</a></li>
                                <li>Select project: <strong style="color: #ff00ff;">reception-calendar-1</strong></li>
                                <li>Navigate to Project Settings → General</li>
                                <li>Copy the Web API Key (starts with "AIzaSy...")</li>
                                <li>Update the <code style="background: rgba(0,0,0,0.5); padding: 2px 6px; border-radius: 4px;">apiKey</code> value in index.html (line 58)</li>
                            </ol>
                        </div>
                        <p style="color: #888; font-size: 12px; margin-top: 20px;">
                            Error: ${escapeHtml(error.message)}
                        </p>
                    </div>
                </div>
            `;
            return; // Stop execution but allow error message to display
        }

        // --- REPORT FIELDS ---
        const REPORT_FIELDS = [
            { id: 'incidents', label: 'Notable Incidents' },
            { id: 'maintenance', label: 'Maintenance Requests' },
            { id: 'notes', label: 'General Notes' },
            { id: 'visitors', label: 'Visitor Log' }
        ];

        function App() {
            const [user, setUser] = useState(null);
            const [currentDate, setCurrentDate] = useState(new Date(2026, 1, 1));
            const [selectedDate, setSelectedDate] = useState(() => new Date().toISOString().split('T')[0]);
            const [events, setEvents] = useState({});
            const [staff, setStaff] = useState({});
            const [messages, setMessages] = useState([]);
            const [reportData, setReportData] = useState({});
            const [globalAlert, setGlobalAlert] = useState('');
            const [isPersonnelModalOpen, setIsPersonnelModalOpen] = useState(false);
            const [isAddModalOpen, setIsAddModalOpen] = useState(false);
            const [editingShift, setEditingShift] = useState(null);
            const [adminCode, setAdminCode] = useState('');
            const [isAdminAuth, setIsAdminAuth] = useState(false);
            const [chatInput, setChatInput] = useState('');
            const [newStaffName, setNewStaffName] = useState('');
            const [newShiftTime, setNewShiftTime] = useState('08:00');
            const chatEndRef = useRef(null);

            // --- Handlers ---
            const updateReport = async (fieldId, value) => {
                if (!user || !selectedDate) return;
                await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('dailyReports').doc(selectedDate).set({
                    [fieldId]: value
                }, { merge: true });
            };

            const handleAssignShift = async (empId) => {
                if (!user || !selectedDate) return;
                await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('shifts').add({
                    date: selectedDate,
                    empId: empId,
                    time: newShiftTime,
                    createdAt: Date.now()
                });
                setIsAddModalOpen(false);
                setNewShiftTime('08:00');
            };

            const handleMasterReset = async () => {
                if (!user) return;
                if (!confirm("ADMIN MASTER RESET: Restore Karen, Izzy, Annalissia, and Hal and reset the February 2026 schedule Baseline?")) return;
                
                const batch = db.batch();
                const baseRef = db.collection('artifacts').doc(appId).collection('public').doc('data');
                
                const coreTeam = [
                    { id: 'u-karen', name: 'Karen', bg: 'bg-cyan-600/80' },
                    { id: 'u-izzy', name: 'Izzy', bg: 'bg-rose-600/80' },
                    { id: 'u-anna', name: 'Annalissia', bg: 'bg-fuchsia-600/80' },
                    { id: 'u-hal', name: 'Hal', bg: 'bg-blue-600/80' }
                ];

                coreTeam.forEach(m => {
                    batch.set(baseRef.collection('staff').doc(m.id), { ...m, createdAt: Date.now() }, { merge: true });
                });

                for (let d = 1; d <= 28; d++) {
                    const dk = `2026-02-${String(d).padStart(2, '0')}`;
                    const dow = new Date(2026, 1, d).getDay();
                    if (dow === 1 || dow === 3) batch.set(baseRef.collection('shifts').doc(), { date: dk, empId: 'u-karen', time: '08:00' });
                    else if (dow === 2 || dow === 4 || dow === 5) batch.set(baseRef.collection('shifts').doc(), { date: dk, empId: 'u-izzy', time: '08:00' });
                    else if (dow === 0 && d === 1) {
                        batch.set(baseRef.collection('shifts').doc(), { date: dk, empId: 'u-hal', time: '16:00' });
                        batch.set(baseRef.collection('shifts').doc(), { date: dk, empId: 'u-anna', time: '08:00' });
                    }
                }
                await batch.commit();
            };

            const sendChat = async (e) => {
                e.preventDefault();
                if (!chatInput.trim() || !user) return;
                await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('messages').add({
                    text: chatInput, createdAt: Date.now(), user: user.uid.slice(-4)
                });
                setChatInput('');
            };

            // --- Effects ---
            useEffect(() => {
                auth.signInAnonymously().then(u => setUser(u.user));
            }, []);

            useEffect(() => {
                if (!user) return;
                const base = db.collection('artifacts').doc(appId).collection('public').doc('data');

                base.collection('shifts').onSnapshot(snap => {
                    const d = {}; snap.forEach(doc => {
                        const s = doc.data(); if (!d[s.date]) d[s.date] = [];
                        d[s.date].push({ ...s, id: doc.id });
                    }); setEvents(d);
                });

                base.collection('staff').onSnapshot(snap => {
                    const l = {}; snap.forEach(doc => { l[doc.id] = doc.data(); });
                    setStaff(l);
                });

                base.collection('messages').onSnapshot(snap => {
                    const msgs = []; snap.forEach(doc => msgs.push({ ...doc.data(), id: doc.id }));
                    setMessages(msgs.sort((a,b) => (a.createdAt || 0) - (b.createdAt || 0)));
                    chatEndRef.current?.scrollIntoView({ behavior: "smooth" });
                });

                base.collection('alerts').doc('current').onSnapshot(snap => {
                    if (snap.exists) setGlobalAlert(snap.data().text);
                });
            }, [user]);

            useEffect(() => {
                if (!user || !selectedDate) return;
                db.collection('artifacts').doc(appId).collection('public').doc('data').collection('dailyReports').doc(selectedDate)
                    .onSnapshot(snap => setReportData(snap.data() || {}));
            }, [user, selectedDate]);

            const calendarMatrix = useMemo(() => {
                const mIdx = currentDate.getMonth(), yIdx = currentDate.getFullYear();
                const total = new Date(yIdx, mIdx + 1, 0).getDate();
                const start = new Date(yIdx, mIdx, 1).getDay();
                const cells = [];
                for (let i = 0; i < start; i++) cells.push(<div key={`e-${i}`} className="min-h-[110px] bg-white/[0.01] border border-white/[0.03]" />);
                for (let d = 1; d <= total; d++) {
                    const dk = `${yIdx}-${String(mIdx + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
                    const dayShifts = events[dk] || [];
                    const isToday = new Date().toISOString().split('T')[0] === dk;
                    cells.push(
                        <div key={dk} onClick={() => setSelectedDate(dk)} className={`min-h-[110px] p-2 border border-white/[0.05] cursor-pointer relative ${selectedDate === dk ? 'bg-cyan-500/10 ring-1 ring-cyan-400' : 'bg-white/[0.01] hover:bg-white/[0.03]'} ${isToday ? 'border-l-2 border-l-cyan-400' : ''}`}>
                            <div className="flex justify-between items-start">
                                <span className="text-sm font-bold opacity-40">{d}</span>
                                <button onClick={(e) => { e.stopPropagation(); setSelectedDate(dk); setIsAddModalOpen(true); }} className="p-1 opacity-20 hover:opacity-100"><PlusIcon /></button>
                            </div>
                            <div className="space-y-1 mt-1">
                                {dayShifts.length === 0 ? <div className="text-[7px] font-black text-rose-500 animate-pulse uppercase flex items-center gap-1 mt-2"><AlertIcon /> NEEDS COVERAGE!</div> : 
                                    dayShifts.map(s => <div key={s.id} className={`text-[9px] p-1 rounded font-bold truncate ${staff[s.empId]?.bg || 'bg-zinc-800'}`}>{staff[s.empId]?.name} <span className="opacity-50 text-[7px]">{s.time}</span></div>)
                                }
                            </div>
                        </div>
                    );
                }
                return cells;
            }, [currentDate, events, selectedDate, staff]);

            if (!user) return <div className="h-screen bg-black flex items-center justify-center text-cyan-400 font-black animate-pulse uppercase tracking-[0.5em]">Establishing Handshake...</div>;

            return (
                <div className="flex h-screen w-screen bg-black overflow-hidden text-xs">
                    {/* NAV RAIL */}
                    <nav className="w-16 border-r border-white/10 flex flex-col items-center py-8 gap-10 bg-[#050505]">
                        <div className="font-black text-cyan-400 text-xl">DS</div>
                        <button onClick={handleMasterReset} className="p-3 bg-cyan-500/10 rounded-xl border border-cyan-500/30 hover:scale-110 transition-all"><SyncIcon /></button>
                        <button onClick={() => setIsPersonnelModalOpen(true)} className="p-3 bg-fuchsia-500/10 rounded-xl border border-fuchsia-500/30 hover:scale-110 transition-all"><PersonnelIcon /></button>
                        <div className="mt-auto flex flex-col items-center gap-3">
                            <div className={`status-pulse w-2.5 h-2.5 rounded-full ${user ? 'bg-emerald-500 shadow-[0_0_10px_#10b981]' : 'bg-amber-500'}`} />
                            <span className="text-[7px] opacity-20 font-black uppercase tracking-widest">Protocol</span>
                        </div>
                    </nav>

                    {/* MAIN CONTENT */}
                    <div className="flex-1 flex flex-col">
                        <header className="h-10 bg-rose-950/20 border-b border-rose-500/30 flex items-center px-6 gap-4">
                            <div className="text-rose-500 font-black text-[9px] uppercase tracking-widest alert-pulse shrink-0 flex items-center gap-2"><AlertIcon /> SYSTEM ALERT</div>
                            <input value={globalAlert} onChange={e => { setGlobalAlert(e.target.value); db.collection('artifacts').doc(appId).collection('public').doc('data').collection('alerts').doc('current').set({ text: e.target.value }); }} className="flex-1 bg-transparent border-none text-[11px] font-bold text-white outline-none placeholder-rose-900" placeholder="Broadcast immediate directive..." />
                        </header>

                        <div className="flex-1 flex overflow-hidden">
                            {/* SIDEBAR LOGS */}
                            <aside className="w-80 bg-[#080808] border-r border-white/5 p-5 flex flex-col gap-4 overflow-y-auto no-scrollbar">
                                <h1 className="text-lg font-black holo-text uppercase tracking-tighter">Archive Logs</h1>
                                <div className="text-cyan-400 font-bold uppercase tracking-widest text-[9px] mb-2">{selectedDate}</div>
                                <div className="flex-1 space-y-3 overflow-y-auto no-scrollbar">
                                    {REPORT_FIELDS.map(f => (
                                        <div key={f.id} className="glass-panel p-3 border border-fuchsia-500/20">
                                            <label className="text-[8px] font-black text-fuchsia-400 uppercase mb-1 block">{f.label}</label>
                                            <textarea value={reportData[f.id] || ''} onChange={e => updateReport(f.id, e.target.value)} className="w-full bg-transparent border-none text-[11px] text-white outline-none h-12 resize-none font-bold" placeholder="..." />
                                        </div>
                                    ))}
                                </div>
                                <div className="glass-panel neon-blue p-3 h-48 flex flex-col mt-auto">
                                    <label className="text-[8px] font-black text-cyan-400 uppercase mb-2 block">Live Intel Feed</label>
                                    <div className="flex-1 overflow-y-auto space-y-1.5 text-[10px] text-slate-300 no-scrollbar">
                                        {messages.map(m => <div key={m.id}><span className="text-cyan-500 font-black mr-1 uppercase">{m.user}:</span>{m.text}</div>)}
                                        <div ref={chatEndRef} />
                                    </div>
                                    <form onSubmit={sendChat} className="flex gap-1 pt-2">
                                        <input value={chatInput} onChange={e => setChatInput(e.target.value)} className="flex-1 bg-black border border-cyan-500/30 rounded p-1.5 text-[10px] outline-none text-white font-bold" placeholder="Broadcast..." />
                                        <button type="submit" className="bg-cyan-600 px-2 rounded text-white font-black">OK</button>
                                    </form>
                                </div>
                            </aside>

                            {/* CALENDAR */}
                            <main className="flex-1 p-8 overflow-y-auto no-scrollbar text-center">
                                <div className="flex justify-between items-end mb-8 no-print">
                                    <div className="text-left text-white">
                                        <h2 className="text-5xl font-black uppercase tracking-tighter drop-shadow-[0_0_15px_rgba(255,255,255,0.2)]">
                                            {currentDate.toLocaleDateString(undefined, { month: 'long', year: 'numeric' })}
                                        </h2>
                                        <div className="text-[10px] font-black text-cyan-400 tracking-[0.5em] uppercase mt-1">Matrix Interface Alpha</div>
                                    </div>
                                    <div className="flex gap-4">
                                        <div className="flex bg-white/5 rounded-xl border border-white/10 p-1 text-white">
                                            <button onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1))} className="p-2 hover:text-cyan-400"><ChevronLeftIcon /></button>
                                            <button onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1))} className="p-2 hover:text-cyan-400"><ChevronRightIcon /></button>
                                        </div>
                                        <button onClick={() => window.print()} className="bg-cyan-500 text-black px-6 py-2 rounded-xl font-black text-xs uppercase shadow-lg">Export Ledger</button>
                                    </div>
                                </div>
                                <div className="grid grid-cols-7 glass-panel neon-blue overflow-hidden rounded-xl">
                                    {['Sun','Mon','Tue','Wed','Thu','Fri','Sat'].map(d => <div key={d} className="py-4 text-center text-[10px] font-black text-cyan-400/60 uppercase tracking-widest border-b border-white/5">{d}</div>)}
                                    {calendarMatrix}
                                </div>
                            </main>
                        </div>
                    </div>

                    {/* MODAL: PERSONNEL */}
                    {isPersonnelModalOpen && (
                        <div className="fixed inset-0 bg-black/95 backdrop-blur-2xl z-[100] flex items-center justify-center p-4">
                            <div className="glass-panel neon-fuchsia p-10 w-full max-w-2xl max-h-[85vh] flex flex-col shadow-2xl">
                                <div className="flex justify-between items-center mb-8 text-fuchsia-400">
                                    <h3 className="text-3xl font-black uppercase">Manifest Hub</h3>
                                    <button onClick={() => { setIsPersonnelModalOpen(false); setIsAdminAuth(false); }} className="text-5xl font-light hover:text-white">&times;</button>
                                </div>
                                {!isAdminAuth ? (
                                    <form onSubmit={e => { e.preventDefault(); if (adminCode === '2026') setIsAdminAuth(true); }} className="space-y-6 flex-1 flex flex-col justify-center items-center">
                                        <div className="text-fuchsia-500 font-black text-xl flex items-center gap-3 alert-pulse"><LockIcon /> RESTRICTED ACCESS</div>
                                        <input type="password" value={adminCode} onChange={e => setAdminCode(e.target.value)} className="w-48 bg-black border border-fuchsia-500/40 rounded-xl p-4 text-center text-3xl text-white outline-none shadow-inner" placeholder="****" autoFocus />
                                        <button type="submit" className="bg-fuchsia-600 px-12 py-3 rounded-xl font-black uppercase text-xs">Unlock</button>
                                    </form>
                                ) : (
                                    <div className="flex flex-col flex-1 overflow-hidden text-left">
                                        <div className="space-y-4 mb-8">
                                            <label className="text-[10px] font-black text-slate-500 uppercase tracking-widest">Enroll New unit</label>
                                            <div className="flex gap-3">
                                                <input value={newStaffName} onChange={e => setNewStaffName(e.target.value)} className="flex-1 bg-black border border-white/10 rounded-xl p-3 text-sm text-white font-black outline-none focus:border-fuchsia-500" placeholder="Identity Label..." />
                                                <button onClick={async () => { if (!newStaffName.trim()) return; await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('staff').add({ name: newStaffName, bg: 'bg-slate-700', createdAt: Date.now() }); setNewStaffName(''); }} className="bg-fuchsia-600 px-6 rounded-xl font-black uppercase text-xs text-white">Enroll</button>
                                            </div>
                                        </div>
                                        <div className="flex-1 overflow-y-auto no-scrollbar space-y-2 pr-2 border-t border-white/5 pt-4 text-white">
                                            {Object.entries(staff).map(([id, s]) => (
                                                <div key={id} className="flex items-center justify-between p-3 glass-panel neon-blue group transition-all hover:bg-white/[0.03]">
                                                    <div className="flex items-center gap-4 text-left">
                                                        <div className={`w-3 h-3 rounded-full ${s.bg} shadow-white/20`} />
                                                        <span className="font-black uppercase text-sm">{s.name}</span>
                                                    </div>
                                                    <button onClick={async () => { if(confirm("Purge unit identifier?")) await db.collection('artifacts').doc(appId).collection('public').doc('data').collection('staff').doc(id).delete(); }} className="text-rose-500 font-black text-[9px] uppercase px-3 py-1 hover:bg-rose-500/10 rounded-lg border border-rose-500/30">PURGE</button>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {/* MODAL: ASSIGN */}
                    {isAddModalOpen && (
                        <div className="fixed inset-0 bg-black/90 backdrop-blur-md z-[100] flex items-center justify-center p-4">
                            <div className="glass-panel neon-blue p-10 w-full max-w-md shadow-2xl text-left">
                                <h3 className="text-2xl font-black text-cyan-400 uppercase mb-8">Deploy Identity</h3>
                                <div className="grid grid-cols-2 gap-2 mb-8">
                                    {Object.entries(staff).map(([id, s]) => <button key={id} onClick={() => handleAssignShift(id)} className={`p-4 rounded-xl text-[10px] font-black uppercase text-white ${s.bg} hover:scale-105 transition-all shadow-lg`}>{s.name}</button>)}
                                </div>
                                <div className="space-y-4 text-center">
                                    <input type="time" value={newShiftTime} onChange={e => setNewShiftTime(e.target.value)} className="w-full bg-black border border-cyan-500/30 rounded-2xl p-5 text-4xl text-white font-black text-center outline-none" />
                                    <button onClick={() => setIsAddModalOpen(false)} className="w-full text-slate-600 text-[10px] font-black uppercase tracking-[0.2em] pt-6 text-center hover:text-white transition-colors">Abort Deployment</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
